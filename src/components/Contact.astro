---
import ContactForm from "./ContactForm.astro";

interface ContactItem {
  icon: string;
  title: string;
  value: string;
  link?: string;
  subtitle?: string;
}

interface Props {
  title?: string;
  subtitle?: string;
  contacts?: ContactItem[];
}

const {
  title = "Начнем работу над вашим проектом?",
  subtitle = "Оставьте заявку, и мы свяжемся с вами в течение 2 часов в рабочее время. Первая консультация бесплатно — обсудим вашу задачу, предложим решение и рассчитаем стоимость.",
  contacts = [
    {
      icon: "email",
      title: "Email",
      value: "info@roxend.ru",
    },
    {
      icon: "telegram",
      title: "Telegram",
      value: "@roxendsoft",
      link: "https://t.me/roxendsoft",
    },
  ],
} = Astro.props;

const getIcon = (iconName: string) => {
  const icons: Record<string, string> = {
    email: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />`,
    phone: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />`,
    telegram: `<path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.161c-.18 1.897-.962 6.502-1.359 8.627-.168.9-.5 1.201-.82 1.23-.697.064-1.226-.461-1.901-.903-1.056-.693-1.653-1.124-2.678-1.8-1.185-.781-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.139-5.062 3.345-.479.329-.913.489-1.302.481-.428-.008-1.252-.241-1.865-.44-.752-.244-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.831-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635.099-.002.321.023.465.14.121.099.155.232.171.326.016.093.036.306.02.472z" />`,
    location: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />`,
  };
  return icons[iconName] || "";
};
---

<section id="contacts" class="contact">
  <div class="contact-container">
    <div class="contact-info">
      <h2 class="contact-title">{title}</h2>
      <p class="contact-subtitle">{subtitle}</p>

      <div class="contact-items">
        {
          contacts.map((contact) => (
            <div class="contact-item">
              <div class="contact-icon">
                <svg
                  class="icon-svg"
                  fill={contact.icon === "telegram" ? "currentColor" : "none"}
                  stroke={contact.icon === "telegram" ? "none" : "currentColor"}
                  viewBox="0 0 24 24"
                  set:html={getIcon(contact.icon)}
                />
              </div>
              <div class="contact-details">
                <strong class="contact-item-title">{contact.title}</strong>
                {contact.link ? (
                  <a
                    href={contact.link}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="contact-link"
                    aria-label={`Связаться через ${contact.title}`}
                  >
                    {contact.value}
                  </a>
                ) : contact.icon === "email" ? (
                  <a
                    href={`mailto:${contact.value}`}
                    class="contact-link"
                    aria-label="Написать на email"
                  >
                    {contact.value}
                  </a>
                ) : (
                  <p class="contact-value">{contact.value}</p>
                )}
                {contact.subtitle && (
                  <p class="contact-subtitle-small">{contact.subtitle}</p>
                )}
              </div>
            </div>
          ))
        }
      </div>
    </div>

    <div class="contact-form-container">
      <ContactForm />
    </div>
  </div>
</section>

<style>
  .contact {
    max-width: 896px;
    margin: 0 auto;
    padding: 48px 16px;
  }

  .contact-container {
    display: grid;
    grid-template-columns: 1fr;
    gap: 32px;
    align-items: start;
  }

  .contact-info {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .contact-title {
    font-size: 32px;
    font-weight: 700;
    color: #000000;
    margin: 0;
  }

  .contact-subtitle {
    font-size: 16px;
    color: #666666;
    line-height: 1.6;
    margin: 0;
  }

  .contact-items {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding-top: 16px;
  }

  .contact-item {
    display: flex;
    align-items: flex-start;
    gap: 16px;
  }

  .contact-icon {
    width: 44px;
    height: 44px;
    background-color: #000000;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .icon-svg {
    width: 22px;
    height: 22px;
    color: #ffffff;
  }

  .contact-details {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .contact-item-title {
    font-size: 15px;
    font-weight: 600;
    color: #000000;
    margin: 0;
  }

  .contact-value {
    font-size: 14px;
    color: #666666;
    margin: 0;
  }

  .contact-link {
    font-size: 14px;
    color: #666666;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .contact-link:hover {
    color: #000000;
  }

  .contact-subtitle-small {
    font-size: 12px;
    color: #999999;
    margin: 0;
  }

  /* Tablet and Desktop */
  @media (min-width: 640px) {
    .contact {
      padding: 80px 24px;
    }

    .contact-title {
      font-size: 36px;
    }

    .contact-subtitle {
      font-size: 18px;
    }

    .contact-icon {
      width: 48px;
      height: 48px;
      border-radius: 16px;
    }

    .icon-svg {
      width: 24px;
      height: 24px;
    }

    .contact-item-title {
      font-size: 16px;
    }

    .contact-value,
    .contact-link {
      font-size: 16px;
    }
  }

  @media (min-width: 1024px) {
    .contact-container {
      grid-template-columns: 1fr 1fr;
      gap: 48px;
    }
  }
</style>
